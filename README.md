# excel-print-script
Скрипт для чтения excel-файлов и превращения его содержимого в sql-инсерт запрос

# Запрос
```sql
INSERT INTO KLT_ORDER VALUES (
  '010469030241757421Mlrraa:LZzYAX91002A92YCYbxC9MEGU2Km2G/rz+CF9eRdno1vQgnz9AJvQbHmXfhFSBHiK9eRVTR2hll4cnlOR5P5kPXo8/CMrZ99W/2Q==',
  50000,
  0,
  0,
  0,
  'Mlrraa:LZzYAX',
  Маркировка остатков
);
GO
```

# Инструкция и Требования:
## Что надо установить:
- nodejs
- python
- установленный xlrd через pip
- после установки среды, запустить в данной директории команду `npm install`

## Запуск скрипта:
- В терминале перейти в директорию скрипта
- Ввести команду: `node index.js ../left ../import -o ./merger-test.text  -- "Маркировка остатков" "Импорт"`
  - `../left` и `../import` - пути к папкам с excel-файлами. Папок может быть сколько угодно, главное написать пути к ним последовательно. Можно прописать как названия конкретных файлов, так и названия папок с n-количеством файлов.
  - `-o ./merger-test.text` - после флага `-o` указывается путь к файлу, в который будет записан результат отработки скрипта
  - `--` - после этого флага указывается название последней колонки. Этот флаг опциональный, им можно не пользоваться, в том случае, если вам не нужны дополнительные колонки. Порядок названий последних колонок должен совпадать с порядком путей к папкам. 

## Установка среды на Windows
- https://nodejs.org/dist/v12.18.1/node-v12.18.1-x86.msi
- https://www.python.org/ftp/python/3.8.3/python-3.8.3-amd64.exe

  Необходимо расставить галочка как на картинках и нажать **Install**
  ![](https://i.imgur.com/IiNVYMT.png)
  ![](https://i.imgur.com/XGK8riW.png)
- Установить пакет **xlrd** с помощью команды
  ![](https://i.imgur.com/a4esFR8.png)